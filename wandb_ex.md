# ğŸ† ë§ˆìŠ¤í¬ ì°©ìš© ìƒíƒœ ë¶„ë¥˜ë¥¼ ìœ„í•œ Image Classification

## ğŸ¥‡ íŒ€ êµ¬ì„±ì›
<div align="center">
<table>
  <tr>
    <td align="center"><a href="https://github.com/bogeoung"><img src="https://avatars.githubusercontent.com/u/50127209?v=4?s=100" width="100px;" alt=""/><br /><sub><b>ê¹€ë³´ê²½</b></sub><br />
    </td>
        <td align="center"><a href="https://github.com/SangphilPark"><img src="https://avatars.githubusercontent.com/u/81211140?v=4?s=100" width="100px;" alt=""/><br /><sub><b>ë°•ìƒí•„</b></sub><br />
    </td>
        <td align="center"><a href="https://github.com/LTSGOD"><img src="https://avatars.githubusercontent.com/u/78635028?v=4?s=100" width="100px;" alt=""/><br /><sub><b>ì´íƒœìˆœ</b></sub><br />
    </td>
        <td align="center"><a href="https://github.com/d-a-d-a"><img src="https://avatars.githubusercontent.com/u/109848297?v=4?s=100" width="100px;" alt=""/><br /><sub><b>ì„í˜„ëª…</b></sub><br />
    </td>
        <td align="center"><a href="https://github.com/CheonJiEun"><img src="https://avatars.githubusercontent.com/u/53997172?v=4?s=100" width="100px;" alt=""/><br /><sub><b>ì²œì§€ì€</b></sub><br />
    </td>
  </tr>
</table>
</div>

<br />

## ğŸ˜· í”„ë¡œì íŠ¸ ì†Œê°œ
COVID-19ì˜ í™•ì‚° ë°©ì§€ë¥¼ ìœ„í•´ ì‚¬ëŒë“¤ì€ ë§ˆìŠ¤í¬ ì°©ìš© ë° ì‚¬íšŒì  ê±°ë¦¬ ë‘ê¸° ë“±ì˜ ë§ì€ ë…¸ë ¥ì„ í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ ì¤‘ ë§ˆìŠ¤í¬ ì°©ìš©ì€ ê°ì—¼ìë¡œë¶€í„°ì˜ ì „íŒŒ ê²½ë¡œë¥¼ ì°¨ë‹¨í•˜ê¸° ìœ„í•œ ì¤‘ìš”í•œ ë°©ë²•ìœ¼ë¡œ, ì˜¬ë°”ë¥´ê²Œ ì°©ìš©í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ë„“ì€ ê³µê³µì¥ì†Œì—ì„œ ë§ì€ ì‚¬ëŒë“¤ì˜ ë§ˆìŠ¤í¬ ì°©ìš© ìƒíƒœë¥¼ ìˆ˜ë™ìœ¼ë¡œ ê²€ì‚¬í•˜ëŠ” ê²ƒì€ ë§ì€ ë¹„ìš©ê³¼ ì‹œê°„ì´ ìš”êµ¬ë©ë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì ì€ ë¹„ìš©ìœ¼ë¡œ ë§ˆìŠ¤í¬ ì°©ìš© ì—¬ë¶€ë¥¼ íŒë³„ ê°€ëŠ¥í•œ ì´ë¯¸ì§€ ë¶„ë¥˜ ëª¨ë¸ì„ ê°œë°œí•˜ì˜€ìŠµë‹ˆë‹¤.

ì´ë²ˆ í”„ë¡œì íŠ¸ëŠ” `ë¶€ìŠ¤íŠ¸ìº í”„ AI Tech` CV íŠ¸ë™ ë‚´ì—ì„œ ì§„í–‰ëœ ëŒ€íšŒì´ë©° F1-Scoreë¥¼ í†µí•´ ìµœì¢…í‰ê°€ë¥¼ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

<br />

## ğŸ“… í”„ë¡œì íŠ¸ ì¼ì •
í”„ë¡œì íŠ¸ ì „ì²´ ì¼ì •

- 2023.04.10 ~ 2023.04.20

í”„ë¡œì íŠ¸ ì„¸ë¶€ ì¼ì •

- 2023.04.10 ~ 2023.04.13 : ë°ì´í„°ì…‹ ë¶„ì„ ë° EDA, í”„ë¡œì íŠ¸ í™˜ê²½ ì„¤ì •
- 2023.04.13 ~ 2023.04.14 : Baseline ì½”ë“œ ì •ë¦½, Augmentation ì‹¤í—˜
- 2023.04.14 ~ 2023.04.16 : Up-Sampling, ì´ë¯¸ì§€ ë°°ê²½ ì œê±°
- 2023.04.15 ~ 2023.04.19 : Model ì‹¤í—˜
- 2023.04.16 ~ 2023.04.19 : Stratified k-fold, Label Smoothing, Multi-Labeling êµ¬í˜„ ë° ì‹¤í—˜
- 2023.04.18 ~ 2023.04.20 : Cutmix ì ìš©, Loss ë° ë‚˜ì´ ê¸°ì¤€ ë³€ê²½ ì‹¤í—˜
- 2023.04.20 ~ 2023.04.20 : Optuna ì—°ë™

<br />

## ğŸ¥ˆ í”„ë¡œì íŠ¸ ê²°ê³¼
- Private ë¦¬ë”ë³´ë“œì—ì„œ ìµœì¢…ì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤.
<img align="center" src="imgs/result.png" width="600" height="80">

<br />

## ğŸ¥‰ ë°ì´í„°ì…‹ êµ¬ì¡°
```
 data/
 â”œâ”€â”€ eval
 â”‚   â”œâ”€â”€ images
 â”‚   â”‚   â””â”€â”€ eval_dataset
 â”‚   â””â”€â”€ info.csv
 â””â”€â”€ train
     â”œâ”€â”€ imgaes_gen
     â”‚   â””â”€â”€ ID_gender_race_age
     â”‚       â”œâ”€â”€ mask1
     â”‚       â”œâ”€â”€ mask2
     â”‚       â”œâ”€â”€ mask3
     â”‚       â”œâ”€â”€ mask4
     â”‚       â”œâ”€â”€ mask5
     â”‚       â”œâ”€â”€ incorrect_mask
     â”‚       â””â”€â”€ normal
     â””â”€â”€ train.csv
```
ì´ ì½”ë“œëŠ” `ë¶€ìŠ¤íŠ¸ìº í”„ AI Tech`ì—ì„œ ì œê³µí•˜ëŠ” ë°ì´í„°ì…‹ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì„±ì„ ë”°ë¦…ë‹ˆë‹¤. 
- ì „ì²´ ì‚¬ëŒ ëª… ìˆ˜ : 4,500
- í•œ ì‚¬ëŒë‹¹ ì‚¬ì§„ì˜ ê°œìˆ˜ : 7ì¥ (ë§ˆìŠ¤í¬ ì°©ìš© 5, ì´ìƒí•˜ê²Œ ì°©ìš©(ì½”ìŠ¤í¬, í„±ìŠ¤í¬) 1, ë¯¸ì°©ìš© 1)
- ì´ë¯¸ì§€ í¬ê¸° : (384, 512)
- ë¶„ë¥˜ í´ë˜ìŠ¤ : ë§ˆìŠ¤í¬ ì°©ìš© ì—¬ë¶€(3), ì„±ë³„(2), ë‚˜ì´(3)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì´ 18ê°œì˜ í´ë˜ìŠ¤ ì¡´ì¬
- ì „ì²´ ë°ì´í„° ì¤‘ í•™ìŠµë°ì´í„° 60%, í‰ê°€ë°ì´í„° 40%ë¡œ ì‚¬ìš©

<br />

## ğŸ¥‰ í”„ë¡œì íŠ¸ êµ¬ì¡°
```
project/
â”œâ”€â”€ .gitignore
â”œâ”€â”€ data_gen.ipynb
â”œâ”€â”€ data_rembg.ipynb
â”œâ”€â”€ dataset.py
â”œâ”€â”€ rembg_dataset.py
â”œâ”€â”€ loss.py
â”œâ”€â”€ model.py
â”œâ”€â”€ train.py
â”œâ”€â”€ skf_train.py
â”œâ”€â”€ train_multiclass.py
â”œâ”€â”€ train_optuna.py
â”œâ”€â”€ train_cutmix_60s.py
â”œâ”€â”€ train_cutmix_all_ages.py
â”œâ”€â”€ skf_train_multiclass.py
â”œâ”€â”€ train_cutmix_multiclass.py
â”œâ”€â”€ rembg_train.py
â”œâ”€â”€ rembg_train_multiclass.py
â”œâ”€â”€ inference.py (ê¸°ë³¸ ì½”ë“œì™€ ë™ì¼í•˜ì—¬ ì—…ë¡œë“œX)
â”œâ”€â”€ inference_multiclass.py
â””â”€â”€ rembg_inference_multiclass.py
```

#### 1) `dataset.py`
- ë§ˆìŠ¤í¬ ë°ì´í„°ì…‹ì„ ì½ê³  ì „ì²˜ë¦¬ë¥¼ ì§„í–‰í•œ í›„ ë°ì´í„°ë¥¼ í•˜ë‚˜ì”© êº¼ë‚´ì£¼ëŠ” Dataset í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•œ íŒŒì¼ 
- CustomAugmentation, MaskBaseDataset, MaskMultiLabelDataset êµ¬í˜„ 
- `rembg_dataset.py` : ë°°ê²½ì œê±°í•œ ë°ì´í„°ì…‹ì„ í™œìš©í•˜ê¸° ìœ„í•´ ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•  ë•Œ .convert(â€˜RGBâ€™)ë¥¼ ì¶”ê°€í•œ íŒŒì¼
#### 2) `loss.py`
- ì´ë¯¸ì§€ ë¶„ë¥˜ì— ì‚¬ìš©ë  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ Loss ë“¤ì„ ì •ì˜í•œ íŒŒì¼
- Cross Entropy, Focal Loss, Label Smoothing Loss, F1 Loss êµ¬í˜„
#### 3) `model.py`
- ë°ì´í„°ë¥¼ ë°›ì•„ ì—°ì‚°ì„ ì²˜ë¦¬í•œ í›„ ê²°ê³¼ ê°’ì„ ë‚´ëŠ” Model í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” íŒŒì¼ 
- vit_base_patch16_224, vit_small_patch16_384, vgg16_bn, resnet50, resnet101, densenet121, densenet201, efficientnet_b1, inception_resnet_v2, swin_tiny_patch4_window7_224, swin_large_patch4_window12_384 êµ¬í˜„
#### 4) `train.py`
- ì‹¤ì œë¡œ, ë§ˆìŠ¤í¬ ë°ì´í„°ì…‹ì„ í†µí•´ CNN ëª¨ë¸ í•™ìŠµì„ ì§„í–‰í•˜ê³  ì™„ì„±ëœ ëª¨ë¸ì„ ì €ì¥í•˜ëŠ” íŒŒì¼ 
- `skf_train.py` : Stratified k-fold ì ìš©
- `train_multiclass.py` : Multi-Labeling ì ìš©
- `train_optuna.py` : optuna ì ìš©
- `train_cutmix_60s.py` : 60ì„¸ ì´ë¯¸ì§€ íŒ¨ì¹˜ë¡œ CutMix 
- `train_cutmix_all_ages.py` : ëª¨ë“  ë‚˜ì´ëŒ€ì— ì´ë¯¸ì§€ íŒ¨ì¹˜ë¡œ CutMix 
- `skf_train_multiclass.py` : Multi-Labelingì— Stratified k-fold ì ìš© 
- `train_cutmix_multiclass.py` : Multi-Labelingì— ëª¨ë“  ë‚˜ì´ëŒ€ì— ì´ë¯¸ì§€ íŒ¨ì¹˜ CutMix ì ìš© 
- `rembg_train.py, rembe_train_multiclass.py` : ë°°ê²½ì œê±°í•œ ë°ì´í„°ì…‹ì„ í™œìš©í•˜ê¸° ìœ„í•´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ ì–¸ë§Œ ë³€ê²½ 
#### 5) `inference.py`
- í•™ìŠµ ì™„ë£Œëœ ëª¨ë¸ì„ í†µí•´ test set ì— ëŒ€í•œ ì˜ˆì¸¡ ê°’ì„ êµ¬í•˜ê³  ì´ë¥¼ .csv í˜•ì‹ìœ¼ë¡œ ì €ì¥í•˜ëŠ” íŒŒì¼ 
- `inference_multiclass.py` : Multi-Labeling ì ìš©
- `rembg_inference_multiclass.py` : ë°°ê²½ì œê±°í•œ ë°ì´í„°ì…‹ì„ í™œìš©í•˜ê¸° ìœ„í•´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ ì–¸ë§Œ ë³€ê²½ 
#### 6) `etc (.ipynb)`
- `data_gen.ipynb`  : albumentations ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•˜ì—¬ train/images datasetsì— 1ê°œì”© ì¡´ì¬í•˜ë˜ incorrect_mask, normal imageë¥¼ 4ê°œì”© Augmentation ì ìš©í•˜ì—¬ Up-Sampling í•˜ëŠ” ì½”ë“œ
- `data_rembg.ipynb` : rembg ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•˜ì—¬ train/images datasetsì— remove í•¨ìˆ˜ë¥¼ í†µí•´ ì‚¬ëŒì„ ì œì™¸í•œ ë°°ê²½ì„ ì œê±°í•˜ëŠ” ì½”ë“œ

<br />

## âš™ï¸ ì„¤ì¹˜

#### Dependencies
ì´ ëª¨ë¸ì€ Ubuntu 18.04.5 LTS, Tesla v100 32GBì˜ í™˜ê²½ì—ì„œ ì‘ì„± ë° í…ŒìŠ¤íŠ¸ ë˜ì—ˆìŠµë‹ˆë‹¤.
ë˜ ëª¨ë¸ ì‹¤í–‰ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.

- torch == 1.7.1
- torchvision==0.8.2
- pandas~=1.2.0
- scikit-learn~=0.24.1
- matplotlib==3.5.1
- numpy~=1.21.5
- python-dotenv~=0.16.0
- Pillow~=7.2.0
- sklearn~=0.0
- timm==0.6.13

Install dependencies: `pip3 install -r requirements.txt`

<br />

## ğŸš€ ë¹ ë¥¸ ì‹œì‘
#### Train
`python train.py --name [ì‹¤í—˜ëª…]`

ì´ ì™¸ ë‹¤ì–‘í•œ í•™ìŠµ ë°©ë²•ì€ `ğŸ¥‰í”„ë¡œì íŠ¸ êµ¬ì¡°/4) train.py`ë¥¼ ì°¸ê³ í•´ì£¼ì„¸ìš”!

#### Evaluation
`python inference.py --model_dir [ëª¨ë¸ì €ì¥ê²½ë¡œ]`

<br />

## ğŸ… Wrap-Up Report   
- [Wrap-Up ReportğŸ‘‘](https://github.com/boostcampaitech5/level1_imageclassification-cv-08/blob/main/docs/%5BCV-08%5D%20LV1%20%EB%9E%A9%EC%97%85%20%EB%A6%AC%ED%8F%AC%ED%8A%B8.pdf)
