
# ğŸ† Sketch ì´ë¯¸ì§€ ë¶„ë¥˜ë¥¼ ìœ„í•œ Image Classification

## ğŸ¥‡ íŒ€ êµ¬ì„±ì›
<div align="center">
<table>
  <tr>
    <td align="center"><a href="https://github.com/Yeon-ksy"><img src="https://avatars.githubusercontent.com/u/124290227?v=4" width="100px;" alt=""/><br /><sub><b>ê¹€ì„¸ì—°</b></sub><br />
    </td>
        <td align="center"><a href="https://github.com/jihyun-0611"><img src="https://avatars.githubusercontent.com/u/78160653?v=4" width="100px;" alt=""/><br /><sub><b>ì•ˆì§€í˜„</b></sub><br />
    </td>
        <td align="center"><a href="https://github.com/dhfpswlqkd"><img src="https://avatars.githubusercontent.com/u/123869205?v=4" width="100px;" alt=""/><br /><sub><b>ê¹€ìƒìœ </b></sub><br />
    </td>
        <td align="center"><a href="https://github.com/K-ple"><img src="https://avatars.githubusercontent.com/u/140207345?v=4" width="100px;" alt=""/><br /><sub><b>ê¹€íƒœìš±</b></sub><br />
    </td>
        <td align="center"><a href="https://github.com/myooooon"><img src="https://avatars.githubusercontent.com/u/168439685?v=4" width="100px;" alt=""/><br /><sub><b>ê¹€ìœ¤ì„œ</b></sub><br />
    </td>
  </tr>
</table>
</div>

<br />

## ğŸ˜· í”„ë¡œì íŠ¸ ì†Œê°œ
Computer Visionì—ì„œëŠ” ë‹¤ì–‘í•œ í˜•íƒœì˜ ì´ë¯¸ì§€ ë°ì´í„°ê°€ í™œìš©ë˜ê³  ìˆìŠµë‹ˆë‹¤. ê·¸ ì¤‘ ìŠ¤ì¼€ì¹˜ëŠ” ì¸ê°„ì˜ ìƒìƒë ¥ê³¼ ê°œë… ì´í•´ë¥¼ ë°˜ì˜í•˜ëŠ” ì¶”ìƒì ì´ê³  ë‹¨ìˆœí™”ëœ í˜•íƒœì˜ ì´ë¯¸ì§€ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ìŠ¤ì¼€ì¹˜ ë°ì´í„°ëŠ” ìƒ‰ìƒ, ì§ˆê°, ì„¸ë¶€ì ì¸ í˜•íƒœê°€ ë¹„êµì  ê²°ì—¬ë˜ì–´ ìˆìœ¼ë©°, ëŒ€ì‹ ì— ê¸°ë³¸ì ì¸ í˜•íƒœì™€ êµ¬ì¡°ì— ì´ˆì ì„ ë§ì¶¥ë‹ˆë‹¤. ì´ë²ˆ í”„ë¡œì íŠ¸ëŠ” ì´ëŸ¬í•œ ìŠ¤ì¼€ì¹˜ ë°ì´í„°ì˜ íŠ¹ì„±ì„ ì´í•´í•˜ê³  ìŠ¤ì¼€ì¹˜ ì´ë¯¸ì§€ë¥¼ í†µí•´ ëª¨ë¸ì´ ê°ì²´ì˜ ê¸°ë³¸ì ì¸ í˜•íƒœì™€ êµ¬ì¡°ë¥¼ í•™ìŠµí•˜ê³  ì¸ì‹í•˜ë„ë¡ í•¨ìœ¼ë¡œì¨, ì¼ë°˜ì ì¸ ì´ë¯¸ì§€ ë°ì´í„°ì™€ì˜ ì°¨ì´ì ì„ ì´í•´í•˜ê³  ë˜ ë‹¤ë¥¸ ê´€ì ì— ëŒ€í•œ ëª¨ë¸ ê°œë°œ ì—­ëŸ‰ì„ ë†’ì´ëŠ”ë°ì— ì´ˆì ì„ ë‘ì—ˆìŠµë‹ˆë‹¤.  

<br />

## ğŸ“… í”„ë¡œì íŠ¸ ì¼ì •
í”„ë¡œì íŠ¸ ì „ì²´ ì¼ì •

- 2024.09.10 ~ 2024.09.26

í”„ë¡œì íŠ¸ ì„¸ë¶€ ì¼ì •

- 2024.09.10 ~ 2024.09.12 : ë°ì´í„°ì…‹ ë¶„ì„ ë° EDA
- 2024.09.12 ~ 2024.09.15 : Augmentation ì‹¤í—˜
- 2024.09.10 ~ 2024.09.26 : Model ì‹¤í—˜
- 2024.09.13 ~ 2024.09.14 : ì½”ë“œ ëª¨ë“ˆí™”
- 2024.09.24 ~ 2024.09.26 : ëª¨ë¸ ì•™ìƒë¸” ì‹¤í—˜
- 2024.09.25 ~ 2024.09.26 : ëª¨ë¸ í‰ê°€
- 2024.09.25 ~ 2024.09.26 : Wandb ì—°ë™

<br />

## ğŸ¥ˆ í”„ë¡œì íŠ¸ ê²°ê³¼
- Private ë¦¬ë”ë³´ë“œì—ì„œ ìµœì¢…ì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤.
<img align="center" src="imgs/result.png" width="600" height="80">

<br />

## ğŸ¥‰ ë°ì´í„°ì…‹ êµ¬ì¡°
```
 data/
 â”œâ”€â”€ eval
 â”‚   â”œâ”€â”€ images
 â”‚   â”‚   â””â”€â”€ eval_dataset
 â”‚   â””â”€â”€ info.csv
 â””â”€â”€ train
     â”œâ”€â”€ imgaes_gen
     â”‚   â””â”€â”€ ID_gender_race_age
     â”‚       â”œâ”€â”€ mask1
     â”‚       â”œâ”€â”€ mask2
     â”‚       â”œâ”€â”€ mask3
     â”‚       â”œâ”€â”€ mask4
     â”‚       â”œâ”€â”€ mask5
     â”‚       â”œâ”€â”€ incorrect_mask
     â”‚       â””â”€â”€ normal
     â””â”€â”€ train.csv
```
ì´ ì½”ë“œëŠ” `ë¶€ìŠ¤íŠ¸ìº í”„ AI Tech`ì—ì„œ ì œê³µí•˜ëŠ” ë°ì´í„°ì…‹ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì„±ì„ ë”°ë¦…ë‹ˆë‹¤. 
- ì „ì²´ ì‚¬ëŒ ëª… ìˆ˜ : 4,500
- í•œ ì‚¬ëŒë‹¹ ì‚¬ì§„ì˜ ê°œìˆ˜ : 7ì¥ (ë§ˆìŠ¤í¬ ì°©ìš© 5, ì´ìƒí•˜ê²Œ ì°©ìš©(ì½”ìŠ¤í¬, í„±ìŠ¤í¬) 1, ë¯¸ì°©ìš© 1)
- ì´ë¯¸ì§€ í¬ê¸° : (384, 512)
- ë¶„ë¥˜ í´ë˜ìŠ¤ : ë§ˆìŠ¤í¬ ì°©ìš© ì—¬ë¶€(3), ì„±ë³„(2), ë‚˜ì´(3)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì´ 18ê°œì˜ í´ë˜ìŠ¤ ì¡´ì¬
- ì „ì²´ ë°ì´í„° ì¤‘ í•™ìŠµë°ì´í„° 60%, í‰ê°€ë°ì´í„° 40%ë¡œ ì‚¬ìš©

<br />

## ğŸ¥‰ í”„ë¡œì íŠ¸ êµ¬ì¡°
```
project/
â”œâ”€â”€ .gitignore
â”œâ”€â”€ data_gen.ipynb
â”œâ”€â”€ data_rembg.ipynb
â”œâ”€â”€ dataset.py
â”œâ”€â”€ rembg_dataset.py
â”œâ”€â”€ loss.py
â”œâ”€â”€ model.py
â”œâ”€â”€ train.py
â”œâ”€â”€ skf_train.py
â”œâ”€â”€ train_multiclass.py
â”œâ”€â”€ train_optuna.py
â”œâ”€â”€ train_cutmix_60s.py
â”œâ”€â”€ train_cutmix_all_ages.py
â”œâ”€â”€ skf_train_multiclass.py
â”œâ”€â”€ train_cutmix_multiclass.py
â”œâ”€â”€ rembg_train.py
â”œâ”€â”€ rembg_train_multiclass.py
â”œâ”€â”€ inference.py (ê¸°ë³¸ ì½”ë“œì™€ ë™ì¼í•˜ì—¬ ì—…ë¡œë“œX)
â”œâ”€â”€ inference_multiclass.py
â””â”€â”€ rembg_inference_multiclass.py
```

#### 1) `dataset.py`
- ë§ˆìŠ¤í¬ ë°ì´í„°ì…‹ì„ ì½ê³  ì „ì²˜ë¦¬ë¥¼ ì§„í–‰í•œ í›„ ë°ì´í„°ë¥¼ í•˜ë‚˜ì”© êº¼ë‚´ì£¼ëŠ” Dataset í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•œ íŒŒì¼ 
- CustomAugmentation, MaskBaseDataset, MaskMultiLabelDataset êµ¬í˜„ 
- `rembg_dataset.py` : ë°°ê²½ì œê±°í•œ ë°ì´í„°ì…‹ì„ í™œìš©í•˜ê¸° ìœ„í•´ ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•  ë•Œ .convert(â€˜RGBâ€™)ë¥¼ ì¶”ê°€í•œ íŒŒì¼
#### 2) `loss.py`
- ì´ë¯¸ì§€ ë¶„ë¥˜ì— ì‚¬ìš©ë  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ Loss ë“¤ì„ ì •ì˜í•œ íŒŒì¼
- Cross Entropy, Focal Loss, Label Smoothing Loss, F1 Loss êµ¬í˜„
#### 3) `model.py`
- ë°ì´í„°ë¥¼ ë°›ì•„ ì—°ì‚°ì„ ì²˜ë¦¬í•œ í›„ ê²°ê³¼ ê°’ì„ ë‚´ëŠ” Model í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” íŒŒì¼ 
- vit_base_patch16_224, vit_small_patch16_384, vgg16_bn, resnet50, resnet101, densenet121, densenet201, efficientnet_b1, inception_resnet_v2, swin_tiny_patch4_window7_224, swin_large_patch4_window12_384 êµ¬í˜„
#### 4) `train.py`
- ì‹¤ì œë¡œ, ë§ˆìŠ¤í¬ ë°ì´í„°ì…‹ì„ í†µí•´ CNN ëª¨ë¸ í•™ìŠµì„ ì§„í–‰í•˜ê³  ì™„ì„±ëœ ëª¨ë¸ì„ ì €ì¥í•˜ëŠ” íŒŒì¼ 
- `skf_train.py` : Stratified k-fold ì ìš©
- `train_multiclass.py` : Multi-Labeling ì ìš©
- `train_optuna.py` : optuna ì ìš©
- `train_cutmix_60s.py` : 60ì„¸ ì´ë¯¸ì§€ íŒ¨ì¹˜ë¡œ CutMix 
- `train_cutmix_all_ages.py` : ëª¨ë“  ë‚˜ì´ëŒ€ì— ì´ë¯¸ì§€ íŒ¨ì¹˜ë¡œ CutMix 
- `skf_train_multiclass.py` : Multi-Labelingì— Stratified k-fold ì ìš© 
- `train_cutmix_multiclass.py` : Multi-Labelingì— ëª¨ë“  ë‚˜ì´ëŒ€ì— ì´ë¯¸ì§€ íŒ¨ì¹˜ CutMix ì ìš© 
- `rembg_train.py, rembe_train_multiclass.py` : ë°°ê²½ì œê±°í•œ ë°ì´í„°ì…‹ì„ í™œìš©í•˜ê¸° ìœ„í•´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ ì–¸ë§Œ ë³€ê²½ 
#### 5) `inference.py`
- í•™ìŠµ ì™„ë£Œëœ ëª¨ë¸ì„ í†µí•´ test set ì— ëŒ€í•œ ì˜ˆì¸¡ ê°’ì„ êµ¬í•˜ê³  ì´ë¥¼ .csv í˜•ì‹ìœ¼ë¡œ ì €ì¥í•˜ëŠ” íŒŒì¼ 
- `inference_multiclass.py` : Multi-Labeling ì ìš©
- `rembg_inference_multiclass.py` : ë°°ê²½ì œê±°í•œ ë°ì´í„°ì…‹ì„ í™œìš©í•˜ê¸° ìœ„í•´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ ì–¸ë§Œ ë³€ê²½ 
#### 6) `etc (.ipynb)`
- `data_gen.ipynb`  : albumentations ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•˜ì—¬ train/images datasetsì— 1ê°œì”© ì¡´ì¬í•˜ë˜ incorrect_mask, normal imageë¥¼ 4ê°œì”© Augmentation ì ìš©í•˜ì—¬ Up-Sampling í•˜ëŠ” ì½”ë“œ
- `data_rembg.ipynb` : rembg ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•˜ì—¬ train/images datasetsì— remove í•¨ìˆ˜ë¥¼ í†µí•´ ì‚¬ëŒì„ ì œì™¸í•œ ë°°ê²½ì„ ì œê±°í•˜ëŠ” ì½”ë“œ

<br />

## âš™ï¸ ì„¤ì¹˜

#### Dependencies
ì´ ëª¨ë¸ì€ Ubuntu 20.04.6 LTS, CUDA Version: 12.2, Tesla v100 32GBì˜ í™˜ê²½ì—ì„œ ì‘ì„± ë° í…ŒìŠ¤íŠ¸ ë˜ì—ˆìŠµë‹ˆë‹¤.
ë˜ ëª¨ë¸ ì‹¤í–‰ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.

- albumentations==1.4.4
- matplotlib==3.8.4
- numpy==2.1.1
- opencv_python==4.9.0.80
- opencv_python_headless==4.10.0.84
- pandas==2.2.3
- Pillow==10.4.0
- scikit_learn==1.4.2
- timm==1.0.9
- torch==2.1.0
- torchvision==0.16.0
- tqdm==4.66.1

Install dependencies: `pip install -r requirements.txt`

<br />

## ğŸš€ ë¹ ë¥¸ ì‹œì‘
#### Train
`python train.py --name [ì‹¤í—˜ëª…]`

ì´ ì™¸ ë‹¤ì–‘í•œ í•™ìŠµ ë°©ë²•ì€ `ğŸ¥‰í”„ë¡œì íŠ¸ êµ¬ì¡°/4) train.py`ë¥¼ ì°¸ê³ í•´ì£¼ì„¸ìš”!

#### Evaluation
`python inference.py --model_dir [ëª¨ë¸ì €ì¥ê²½ë¡œ]`

<br />

## ğŸ… Wrap-Up Report   
- [Wrap-Up ReportğŸ‘‘](https://onedrive.live.com/edit?id=1D3C82CAEE19B27B!sbb0352dc60244cd4bd69c3597c7c9088&resid=1D3C82CAEE19B27B!sbb0352dc60244cd4bd69c3597c7c9088&cid=1d3c82caee19b27b&ithint=file%2Cdocx&redeem=aHR0cHM6Ly8xZHJ2Lm1zL3cvYy8xZDNjODJjYWVlMTliMjdiL0VkeFNBN3NrWU5STXZXbkRXWHg4a0lnQnFfbU1nbTNfUVlnUFhyQ193d0otQWc_ZT16ZDRlbWI&migratedtospo=true&wdo=2)